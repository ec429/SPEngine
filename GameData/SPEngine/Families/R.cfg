SPEFamily:NEEDS[RealFuels]
{
	letter = R
	description = Small hydrolox vacuum engine, like RL10.
	usesPartUpgrades = True
	minTf = 0.3
	minIgnitions = 1
	TechLevel
	{
		// RL10A-1
		puRequired = SPEngineTech-R0
		maxThrust = 100
		isp
		{
			key = 0 422
			key = 1 200
		}
		PROPELLANT
		{
			name = LqdHydrogen
			ratio = 0.7631
			DrawGauge = True
		}
		PROPELLANT
		{
			name = LqdOxygen
			ratio = 0.2369
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 0.5
		}
		maxIgnitions = 5 // RL10 has 10, but that's rather a lot and we don't want people to save _too_ much money by going for 2 or 3
		mass = 0.2
		cost = 2100 // yields 1298.7 for an RL10A-1
		toolCost = 39000 // yields 24118.7 for an RL10A-1
	}
	TechLevel
	{
		// RL10A-3-1
		puRequired = SPEngineTech-R1
		maxThrust = 100
		isp
		{
			key = 0 433
			key = 1 255
		}
		PROPELLANT
		{
			name = LqdHydrogen
			ratio = 0.7631
			DrawGauge = True
		}
		PROPELLANT
		{
			name = LqdOxygen
			ratio = 0.2369
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 0.5
		}
		maxIgnitions = 5
		mass = 0.1915
		cost = 2500 // yields 1546.1 for an RL10A-3-1
		toolCost = 57000 // yields 15955.5 to upgrade from an RL10A-1
	}
	TechLevel
	{
		// RL10A-3-3
		puRequired = SPEngineTech-R2
		maxThrust = 100
		isp
		{
			key = 0 444
			key = 1 255
		}
		PROPELLANT
		{
			name = LqdHydrogen
			ratio = 0.7631
			DrawGauge = True
		}
		PROPELLANT
		{
			name = LqdOxygen
			ratio = 0.2369
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 0.5
		}
		maxIgnitions = 6 // here, have an extra ignition for free.  Don't say I never do anything for you!
		mass = 0.1882
		cost = 2750 // yields 1700.7 for an RL10A-3-3
		toolCost = 71500 // yields 16017.3 to continue upgrading from RL10A-1
	}
	TechLevel
	{
		// RL10A-3-3A
		puRequired = SPEngineTech-R3
		maxThrust = 109.6
		isp
		{
			key = 0 444
			key = 1 255
		}
		PROPELLANT
		{
			name = LqdHydrogen
			ratio = 0.7631
			DrawGauge = True
		}
		PROPELLANT
		{
			name = LqdOxygen
			ratio = 0.2369
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 0.5
		}
		maxIgnitions = 6
		mass = 0.1882
		cost = 3250 // yields 2009.9 for an RL10A-3-3
		toolCost = 76600 // yields 11997.5 to continue upgrading from RL10A-1
	}
	TechLevel
	{
		// RL10A-4
		puRequired = SPEngineTech-R4
		maxThrust = 138
		isp
		{
			key = 0 449
			key = 1 255
		}
		PROPELLANT
		{
			name = LqdHydrogen
			ratio = 0.7454
			DrawGauge = True
		}
		PROPELLANT
		{
			name = LqdOxygen
			ratio = 0.2546
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 0.5
		}
		maxIgnitions = 6
		mass = 0.23145
		cost = 3725 // yields 2303.6 for an RL10A-4
		toolCost = 85600 // yields 15040.2 to continue upgrading from RL10A-1
	}
	TechLevel
	{
		// RL10A-4-1-2
		puRequired = SPEngineTech-R5
		maxThrust = 148
		isp
		{
			key = 0 451
			key = 1 255
		}
		PROPELLANT
		{
			name = LqdHydrogen
			ratio = 0.7454
			DrawGauge = True
		}
		PROPELLANT
		{
			name = LqdOxygen
			ratio = 0.2546
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 0.5
		}
		maxIgnitions = 6
		mass = 0.23
		cost = 4040 // yields 2498.5 for an RL10A-4-1-2
		toolCost = 97575 // yields 17993.2 to continue upgrading from RL10A-1
	}
	TechLevel
	{
		// RL10C-1
		puRequired = SPEngineTech-R6
		maxThrust = 152
		isp
		{
			key = 0 449.7
			key = 1 255
		}
		PROPELLANT
		{
			name = LqdHydrogen
			ratio = 0.7454
			DrawGauge = True
		}
		PROPELLANT
		{
			name = LqdOxygen
			ratio = 0.2546
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 0.5
		}
		maxIgnitions = 6
		mass = 0.263
		cost = 3725 // yields 2303.6 for an RL10C-1
		toolCost = 110500 // yields 20061.8 to continue upgrading from RL10A-1
	}
	TechLevel
	{
		// CECE-High
		puRequired = SPEngineTech-R7
		maxThrust = 164
		isp
		{
			key = 0 465
			key = 1 100
		}
		PROPELLANT
		{
			name = LqdHydrogen
			ratio = 0.7325
			DrawGauge = True
		}
		PROPELLANT
		{
			name = LqdOxygen
			ratio = 0.2675
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 0.5
		}
		maxIgnitions = 50 // This is really quite high (reusable tugs and all that); a single-ignition design costs about 52%
		mass = 0.3525
		cost = 4500 // yields 2782.9 for an upgraded RL10A-1
		toolCost = 120750 // yields 20006.2 to continue upgrading from RL10A-1
	}
}

PARTUPGRADE
{
	name = SPEngineTech-R0
	techRequired = prototypeHydrolox
	entryCost = 0
	cost = 0
	title = R-class Procedural Engine family
	basicInfo = Engine Performance Upgrade
	manufacturer = Engine Upgrade
	description = Unlocks the R-class Procedural Engine family at techlevel 1.\n\nResembling the Pratt & Whitney RL10A-1, these high-performance upper-stage engines burn LH2/LOx.  Besides their impressive Isp, they also boast up to 5 ignitions.  However, the new technologies for working with liquid hydrogen are expensive and unreliable.  Burntime is just over 7 minutes.
	partIcon = ROE-UpgradeIcon-Coatl
}

PARTUPGRADE
{
	name = SPEngineTech-R1
	techRequired = earlyHydrolox
	entryCost = 0
	cost = 0
	title = R-class Procedural Engine upgrade: TL2
	basicInfo = Engine Performance Upgrade
	manufacturer = Engine Upgrade
	description = The R-class Procedural Engine family now supports techlevel 2 for increased performance.\n\nResembling the Pratt & Whitney RL10A-3-1, these engines offer better Isp and reliability, and a burntime extending to nearly 8 minutes, but are even more costly to build.
	partIcon = ROE-UpgradeIcon-Coatl
}

PARTUPGRADE
{
	name = SPEngineTech-R2
	techRequired = improvedHydrolox
	entryCost = 0
	cost = 0
	title = R-class Procedural Engine upgrade: TL3
	basicInfo = Engine Performance Upgrade
	manufacturer = Engine Upgrade
	description = The R-class Procedural Engine family now supports techlevel 3 for increased performance.\n\nResembling the Pratt & Whitney RL10A-3-3, these engines are yet more reliable and vacuum Isp continues to rise, but cost rises with it.  At least they have an additional ignition.
	partIcon = ROE-UpgradeIcon-Coatl
}

PARTUPGRADE
{
	name = SPEngineTech-R3
	techRequired = hydrolox1972
	entryCost = 0
	cost = 0
	title = R-class Procedural Engine upgrade: TL4
	basicInfo = Engine Performance Upgrade
	manufacturer = Engine Upgrade
	description = The R-class Procedural Engine family now supports techlevel 4 for increased performance.\n\nResembling the Pratt & Whitney RL10A-3-3A, these engines have nearly 10% more thrust and are rather more reliable, but more expensive still.
	partIcon = ROE-UpgradeIcon-Coatl
}

PARTUPGRADE
{
	name = SPEngineTech-R4
	techRequired = hydrolox1992
	entryCost = 0
	cost = 0
	title = R-class Procedural Engine upgrade: TL5
	basicInfo = Engine Performance Upgrade
	manufacturer = Engine Upgrade
	description = The R-class Procedural Engine family now supports techlevel 5 for increased performance.\n\nResembling the Pratt & Whitney RL10A-4, these engines have more thrust but a shorter burntime of about 6Â½ minutes.  At least they're more reliable.
	partIcon = ROE-UpgradeIcon-Coatl
}

PARTUPGRADE
{
	name = SPEngineTech-R5
	techRequired = hydrolox1998
	entryCost = 0
	cost = 0
	title = R-class Procedural Engine upgrade: TL6
	basicInfo = Engine Performance Upgrade
	manufacturer = Engine Upgrade
	description = The R-class Procedural Engine family now supports techlevel 6 for increased performance.\n\nResembling the Pratt & Whitney RL10A-4-1 and -2, these engines can burn for over 14 minutes, delivering more thrust than ever, but the price tag is also more than ever.
	partIcon = ROE-UpgradeIcon-Coatl
}

PARTUPGRADE
{
	name = SPEngineTech-R6
	techRequired = hydrolox2009
	entryCost = 0
	cost = 0
	title = R-class Procedural Engine upgrade: TL7
	basicInfo = Engine Performance Upgrade
	manufacturer = Engine Upgrade
	description = The R-class Procedural Engine family now supports techlevel 7 for increased performance.\n\nResembling the Pratt & Whitney Rocketdyne RL10C-1, these engines are cheaper than TL6 and have a burntime of almost 19 minutes.  Thrust also increases slightly.
	partIcon = ROE-UpgradeIcon-Coatl
}

PARTUPGRADE
{
	name = SPEngineTech-R7
	techRequired = hydrolox2014
	entryCost = 0
	cost = 0
	title = R-class Procedural Engine upgrade: TL8
	basicInfo = Engine Performance Upgrade
	manufacturer = Engine Upgrade
	description = The R-class Procedural Engine family now supports techlevel 8 for increased performance.\n\nResembling the Pratt & Whitney Rocketdyne CECE-High, these engines offer improved Isp and thrust with four nines of reliability, but are the most expensive R-class variant.
	partIcon = ROE-UpgradeIcon-Coatl
}

@ENTRYCOSTMODS:AFTER[RP-0]
{
	SPEngineTech-R0 = 14000,HydroloxPumps
	SPEngineTech-R1 = SPEngineTech-R0,5000
	SPEngineTech-R2TP = SPEngineTech-R0,5000
	SPEngineTech-R2 = SPEngineTech-R1,SPEngineTech-R2TP
	SPEngineTech-R3 = SPEngineTech-R2,18000
	SPEngineTech-R4TP = SPEngineTech-R2TP,10000
	SPEngineTech-R4 = SPEngineTech-R3,10000,SPEngineTech-R4TP
	SPEngineTech-R5 = SPEngineTech-R4,32000
	SPEngineTech-R6 = SPEngineTech-R5,40000
	SPEngineTech-R7TP = SPEngineTech-R4TP,80000
	SPEngineTech-R7 = SPEngineTech-R6,SPEngineTech-R7TP,60000
}

@PART[*]:HAS[@MODULE[ModuleSPEngine]:HAS[#familyLetter[R]],!MODULE[TestFlightInterop]]:BEFORE[zTestFlight]
{
	!TESTFLIGHT,*{}
	TESTFLIGHT
	{
		name = SPEngine-R-0 // based on RL10A-1
		ratedBurnTime = 430
		ignitionReliabilityStart = 0.7
		ignitionReliabilityEnd = 0.85
		cycleReliabilityStart = 0.81811
		cycleReliabilityEnd = 0.94539
		ignitionDynPresFailMultiplier = 0.1
	}
	TESTFLIGHT
	{
		name = SPEngine-R-1 // based on RL10A-3-1
		ratedBurnTime = 470
		ignitionReliabilityStart = 0.8
		ignitionReliabilityEnd = 0.93
		cycleReliabilityStart = 0.85712
		cycleReliabilityEnd = 0.96428
		ignitionDynPresFailMultiplier = 0.1

		techTransfer = SPEngine-R-0:50&RL10A-1:25
	}
	TESTFLIGHT
	{
		name = SPEngine-R-2 // based on RL10A-3-3
		ratedBurnTime = 470
		ignitionReliabilityStart = 0.9
		ignitionReliabilityEnd = 0.97
		cycleReliabilityStart = 0.9201
		cycleReliabilityEnd = 0.98402
		ignitionDynPresFailMultiplier = 0.1

		techTransfer = SPEngine-R-1,SPEngine-R-0:50&RL10A-3-1,RL10A-1:25
	}
	TESTFLIGHT
	{
		name = SPEngine-R-3 // based on RL10A-3-3A
		ratedBurnTime = 470
		ignitionReliabilityStart = 0.98
		ignitionReliabilityEnd = 0.9995
		cycleReliabilityStart = 0.92856
		cycleReliabilityEnd = 0.988
		ignitionDynPresFailMultiplier = 0.1

		techTransfer = SPEngine-R-2,SPEngine-R-1,SPEngine-R-0:50&RL10A-3-3,RL10A-3-1,RL10A-1:25
	}
	TESTFLIGHT
	{
		name = SPEngine-R-4 // based on RL10A-4
		ratedBurnTime = 392
		ignitionReliabilityStart = 0.98
		ignitionReliabilityEnd = 0.9995
		cycleReliabilityStart = 0.962368
		cycleReliabilityEnd = 0.994512
		ignitionDynPresFailMultiplier = 0.1

		techTransfer = SPEngine-R-3,SPEngine-R-2,SPEngine-R-1,SPEngine-R-0:50&RL10A-3-3A,RL10A-3-3,RL10A-3-1,RL10A-1:25
	}
	TESTFLIGHT
	{
		name = SPEngine-R-5 // based on RL10A-4-1-2
		ratedBurnTime = 850
		ignitionReliabilityStart = 0.98
		ignitionReliabilityEnd = 0.9995
		cycleReliabilityStart = 0.94968
		cycleReliabilityEnd = 0.9852
		ignitionDynPresFailMultiplier = 0.1

		// only need to keep 4 generations as our generation penalty is 25%
		techTransfer = SPEngine-R-4,SPEngine-R-3,SPEngine-R-2,SPEngine-R-1:50&RL10A-4,RL10A-3-3A,RL10A-3-3,RL10A-3-1:25
	}
	TESTFLIGHT
	{
		name = SPEngine-R-6 // based on RL10C-1
		ratedBurnTime = 1130
		ignitionReliabilityStart = 0.98
		ignitionReliabilityEnd = 0.9995
		cycleReliabilityStart = 0.980771
		cycleReliabilityEnd = 0.999062
		ignitionDynPresFailMultiplier = 0.08

		techTransfer = SPEngine-R-5,SPEngine-R-4,SPEngine-R-3,SPEngine-R-2:50&RL10B-2,RL10A-4-1-2,RL10A-4,RL10A-3-3A:25
	}
	TESTFLIGHT
	{
		name = SPEngine-R-7 // based on CECE-High
		ratedBurnTime = 9000
		ratedContinuousBurnTime = 1200
		ignitionReliabilityStart = 0.99975
		ignitionReliabilityEnd = 0.99995
		cycleReliabilityStart = 0.99975
		cycleReliabilityEnd = 0.99995

		// not very much techTransfer; it's not exactly a brand new engine but it's a significant jump
		techTransfer = SPEngine-R-6:20&RL10C-1,RL10B-2:10
	}
}
