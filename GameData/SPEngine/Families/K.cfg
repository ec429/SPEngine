SPEFamily:NEEDS[RealFuels]
{
	letter = K
	description = Kerolox atmospheric engine (not huge).  Examples include X405, LR79/89/H-1, LR87 (Titan I), Merlin1.
	usesPartUpgrades = True
	minTf = 0.2
	TechLevel
	{
		// S-3
		puRequired = SPEngineTech-K0
		maxThrust = 800
		isp
		{
			key = 0 280
			key = 1 246
		}
		PROPELLANT
		{
			name = Kerosene
			ratio = 0.382 // Mixture ratios to match L-class, for building proc Atlases, even though the rest of our configs are based off LR79s not 89s.
			DrawGauge = True
		}
		PROPELLANT
		{
			name = LqdOxygen
			ratio = 0.618
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 0.5
		}
		IGNITOR_RESOURCE
		{
			name = TEATEB
			amount = 1
		}
		maxIgnitions = 0
		mass = 1.14
		cost = 424
		toolCost = 11250 // yields 7973.7 for S-3
	}
	TechLevel
	{
		// S-3D
		puRequired = SPEngineTech-K1
		maxThrust = 1000
		isp
		{
			key = 0 282
			key = 1 248
		}
		PROPELLANT
		{
			name = Kerosene
			ratio = 0.382
			DrawGauge = True
		}
		PROPELLANT
		{
			name = LqdOxygen
			ratio = 0.618
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 0.5
		}
		IGNITOR_RESOURCE
		{
			name = TEATEB
			amount = 1
		}
		maxIgnitions = 0
		mass = 1.132
		cost = 430
		toolCost = 11825 // yields 2002.3 to upgrade from an S-3
	}
	TechLevel
	{
		// LR79-NA-9
		puRequired = SPEngineTech-K2
		maxThrust = 1024
		isp
		{
			key = 0 284
			key = 1 245
		}
		PROPELLANT
		{
			name = Kerosene
			ratio = 0.382
			DrawGauge = True
		}
		PROPELLANT
		{
			name = LqdOxygen
			ratio = 0.618
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 0.5
		}
		IGNITOR_RESOURCE
		{
			name = TEATEB
			amount = 1
		}
		maxIgnitions = 0
		mass = 1.168
		cost = 462
		toolCost = 12275 // yields 1995.2 to continue upgrading from S-3
	}
	TechLevel
	{
		// LR79-NA-11
		puRequired = SPEngineTech-K3
		maxThrust = 1125
		isp
		{
			key = 0 286.2
			key = 1 248.3
		}
		PROPELLANT
		{
			name = Kerosene
			ratio = 0.382
			DrawGauge = True
		}
		PROPELLANT
		{
			name = LqdOxygen
			ratio = 0.618
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 0.5
		}
		IGNITOR_RESOURCE
		{
			name = TEATEB
			amount = 1
		}
		maxIgnitions = 0
		mass = 1.225
		cost = 480
		toolCost = 12650 // yields 2005.8 to continue upgrading from S-3
	}
	TechLevel
	{
		// H-1-SaturnI
		puRequired = SPEngineTech-K4
		maxThrust = 1200
		isp
		{
			key = 0 289
			key = 1 245
		}
		PROPELLANT
		{
			name = Kerosene
			ratio = 0.382
			DrawGauge = True
		}
		PROPELLANT
		{
			name = LqdOxygen
			ratio = 0.618
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 0.5
		}
		IGNITOR_RESOURCE
		{
			name = TEATEB
			amount = 1
		}
		maxIgnitions = 0
		mass = 0.77
		cost = 268
		toolCost = 17175 // yields 5000.4 to continue upgrading from S-3
	}
	TechLevel
	{
		// H-1-SaturnIB
		puRequired = SPEngineTech-K5
		maxThrust = 1280
		isp
		{
			key = 0 296
			key = 1 265
		}
		PROPELLANT
		{
			name = Kerosene
			ratio = 0.382
			DrawGauge = True
		}
		PROPELLANT
		{
			name = LqdOxygen
			ratio = 0.618
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 0.5
		}
		IGNITOR_RESOURCE
		{
			name = TEATEB
			amount = 1
		}
		maxIgnitions = 0
		mass = 1.175
		cost = 275
		toolCost = 22200 // yields 5996.2 to continue upgrading from S-3
	}
	TechLevel
	{
		// RS-27
		puRequired = SPEngineTech-K6
		maxThrust = 1275
		isp
		{
			key = 0 295
			key = 1 264
		}
		PROPELLANT
		{
			name = Kerosene
			ratio = 0.382
			DrawGauge = True
		}
		PROPELLANT
		{
			name = LqdOxygen
			ratio = 0.618
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 0.5
		}
		IGNITOR_RESOURCE
		{
			name = TEATEB
			amount = 1
		}
		maxIgnitions = 0
		mass = 1.225
		cost = 260
		toolCost = 22000 // yields 3005.2 to continue upgrading from S-3
	}
	TechLevel
	{
		// RS-27A
		puRequired = SPEngineTech-K7
		maxThrust = 1320
		isp
		{
			key = 0 302
			key = 1 255
		}
		PROPELLANT
		{
			name = Kerosene
			ratio = 0.382
			DrawGauge = True
		}
		PROPELLANT
		{
			name = LqdOxygen
			ratio = 0.618
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 0.5
		}
		IGNITOR_RESOURCE
		{
			name = TEATEB
			amount = 1
		}
		maxIgnitions = 1 // while RS-27A didn't airlight, it doesn't seem like a completely unreasonable thing to do by this point
		mass = 1.306
		cost = 328
		toolCost = 21825 // yields 2994.6 to continue upgrading from S-3
	}
	TechLevel
	{
		// Merlin1C
		puRequired = SPEngineTech-K8
		maxThrust = 1400 // that's a lot more than the Merlin1C, but let's keep going up
		isp
		{
			key = 0 304.8
			key = 1 267
		}
		PROPELLANT
		{
			name = Kerosene
			ratio = 0.382
			DrawGauge = True
		}
		PROPELLANT
		{
			name = LqdOxygen
			ratio = 0.618
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 0.5
		}
		IGNITOR_RESOURCE
		{
			name = TEATEB
			amount = 1.0
		}
		maxIgnitions = 1
		mass = 1.48
		cost = 640
		toolCost = 24500 // yields 4989.8 to continue upgrading from S-3, or 6825.7 to create Merlin1C from scratch, or 10865.3 to create from scratch something that will become Merlin1D++
	}
	TechLevel
	{
		// Merlin1D
		puRequired = SPEngineTech-K9
		maxThrust = 1600
		minThrottle = 0.4
		isp
		{
			key = 0 311
			key = 1 282
		}
		PROPELLANT
		{
			name = Kerosene
			ratio = 0.382
			DrawGauge = True
		}
		PROPELLANT
		{
			name = LqdOxygen
			ratio = 0.618
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 0.5
		}
		IGNITOR_RESOURCE
		{
			name = TEATEB
			amount = 0.25 // should really be 1.0 but we can't change the stored amount
		}
		maxIgnitions = 4 // hey look, Elon developed restarts!
		mass = 0.89
		cost = 460
		toolCost = 30000 // yields 7371.2 to continue upgrading from S-3, or 2897.5 to upgrade a Merlin1C, or 4612.2 to upgrade that which will in time become Merlin1D++
	}
	TechLevel
	{
		// Merlin1D++
		puRequired = SPEngineTech-K10
		maxThrust = 1800
		minThrottle = 0.361
		isp
		{
			key = 0 311
			key = 1 288.5
		}
		PROPELLANT
		{
			name = Kerosene
			ratio = 0.382
			DrawGauge = True
		}
		PROPELLANT
		{
			name = LqdOxygen
			ratio = 0.618
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 0.5
		}
		IGNITOR_RESOURCE
		{
			name = TEATEB
			amount = 0.25 // should really be 1.0 but we can't change the stored amount
		}
		maxIgnitions = 4
		mass = 0.81
		cost = 400
		toolCost = 35250 // yields 7973.7 to continue upgrading from S-3, or 3134.3 to continue upgrading from Merlin1C, or 4989.2 to upgrade to a Merlin1D++
	}
}

PARTUPGRADE
{
	name = SPEngineTech-K0
	techRequired = orbitalRocketry1956
	entryCost = 0
	cost = 0
	title = K-class Procedural Engine family
	basicInfo = Engine Performance Upgrade
	manufacturer = Engine Upgrade
	description = Unlocks the K-class Procedural Engine family at techlevel 1.\n\nResembling the Rocketdyne S-3, these early kerosene/LOx booster engines are unreliable but offer far better performance than alcohol-burning engines.
	partIcon = ROE-UpgradeIcon-Coatl
}

PARTUPGRADE
{
	name = SPEngineTech-K1
	techRequired = orbitalRocketry1958
	entryCost = 0
	cost = 0
	title = K-class Procedural Engine upgrade: TL2
	basicInfo = Engine Performance Upgrade
	manufacturer = Engine Upgrade
	description = The K-class Procedural Engine family now supports techlevel 2 for increased performance.\n\nResembling the Rocketdyne S-3D, these engines deliver 25% more thrust at an improved Isp, and reliability is much better.
	partIcon = ROE-UpgradeIcon-Coatl
}

PARTUPGRADE
{
	name = SPEngineTech-K2
	techRequired = orbitalRocketry1959
	entryCost = 0
	cost = 0
	title = K-class Procedural Engine upgrade: TL3
	basicInfo = Engine Performance Upgrade
	manufacturer = Engine Upgrade
	description = The K-class Procedural Engine family now supports techlevel 3 for increased performance.\n\nResembling the Rocketdyne LR79-NA-9, these engines are more reliable than TL2 and have a slightly higher expansion ratio.
	partIcon = ROE-UpgradeIcon-Coatl
}

PARTUPGRADE
{
	name = SPEngineTech-K3
	techRequired = orbitalRocketry1960
	entryCost = 0
	cost = 0
	title = K-class Procedural Engine upgrade: TL4
	basicInfo = Engine Performance Upgrade
	manufacturer = Engine Upgrade
	description = The K-class Procedural Engine family now supports techlevel 4 for increased performance.\n\nResembling the Rocketdyne LR79-NA-11, these engines offer 10% more thrust, a slight gain in specific impulse, and further reliability improvements.
	partIcon = ROE-UpgradeIcon-Coatl
}

PARTUPGRADE
{
	name = SPEngineTech-K4
	techRequired = orbitalRocketry1961
	entryCost = 0
	cost = 0
	title = K-class Procedural Engine upgrade: TL5
	basicInfo = Engine Performance Upgrade
	manufacturer = Engine Upgrade
	description = The K-class Procedural Engine family now supports techlevel 5 for increased performance.\n\nResembling early models of the Rocketdyne H-1, these engines offer 7% more thrust, but burntime is slightly shorter at 2Â½ minutes and reliability is no better than TL2.
	partIcon = ROE-UpgradeIcon-Coatl
}

PARTUPGRADE
{
	name = SPEngineTech-K5
	techRequired = orbitalRocketry1965
	entryCost = 0
	cost = 0
	title = K-class Procedural Engine upgrade: TL6
	basicInfo = Engine Performance Upgrade
	manufacturer = Engine Upgrade
	description = The K-class Procedural Engine family now supports techlevel 6 for increased performance.\n\nResembling later models of the Rocketdyne H-1, these engines have increased thrust and Isp and much better reliability than TL5 (as good as TL3), along with a 3 minute burntime.
	partIcon = ROE-UpgradeIcon-Coatl
}

PARTUPGRADE
{
	name = SPEngineTech-K6
	techRequired = orbitalRocketry1972
	entryCost = 0
	cost = 0
	title = K-class Procedural Engine upgrade: TL7
	basicInfo = Engine Performance Upgrade
	manufacturer = Engine Upgrade
	description = The K-class Procedural Engine family now supports techlevel 7 for increased performance.\n\nResembling the Rocketdyne RS-27, these engines are much more reliable than earlier techlevels and can run for up to 4 minutes, at the cost of a marginal decrease in thrust.
	partIcon = ROE-UpgradeIcon-Coatl
}

PARTUPGRADE
{
	name = SPEngineTech-K7
	techRequired = orbitalRocketry1986
	entryCost = 0
	cost = 0
	title = K-class Procedural Engine upgrade: TL8
	basicInfo = Engine Performance Upgrade
	manufacturer = Engine Upgrade
	description = The K-class Procedural Engine family now supports techlevel 8 for increased performance.\n\nResembling the Rocketdyne RS-27A, these engines have a higher expansion ratio than TL7, and can airlight and run for up to 4Â¾ minutes.
	partIcon = ROE-UpgradeIcon-Coatl
}

PARTUPGRADE
{
	name = SPEngineTech-K8
	techRequired = orbitalRocketry2004
	entryCost = 0
	cost = 0
	title = K-class Procedural Engine upgrade: TL9
	basicInfo = Engine Performance Upgrade
	manufacturer = Engine Upgrade
	description = The K-class Procedural Engine family now supports techlevel 9 for increased performance.\n\nLoosely resembling the SpaceX Merlin 1C, these engines have increased thrust and Isp and a 5 minute burntime.
	partIcon = ROE-UpgradeIcon-Coatl
}

PARTUPGRADE
{
	name = SPEngineTech-K9
	techRequired = orbitalRocketry2009
	entryCost = 0
	cost = 0
	title = K-class Procedural Engine upgrade: TL10
	basicInfo = Engine Performance Upgrade
	manufacturer = Engine Upgrade
	description = The K-class Procedural Engine family now supports techlevel 10 for increased performance.\n\nResembling the SpaceX Merlin 1D, these engines support up to 4 ignitions and a throttling capability in addition to their thrust, Isp and burntime improvements.
	partIcon = ROE-UpgradeIcon-Coatl
}

PARTUPGRADE
{
	name = SPEngineTech-K10
	techRequired = orbitalRocketry2014
	entryCost = 0
	cost = 0
	title = K-class Procedural Engine upgrade: TL11
	basicInfo = Engine Performance Upgrade
	manufacturer = Engine Upgrade
	description = The K-class Procedural Engine family now supports techlevel 11 for increased performance.\n\nResembling the SpaceX Merlin 1D++, these engines deliver yet more thrust and sea-level Isp, almost overlapping with the bottom of the F-class range.
	partIcon = ROE-UpgradeIcon-Coatl
}

@ENTRYCOSTMODS:AFTER[RP-0]
{
	SPEngineTech-K0 = 2000,Navaho-TP
	SPEngineTech-K1 = SPEngineTech-K0,Navaho-TP-1958
	SPEngineTech-K2 = SPEngineTech-K1,Navaho-TP-1959
	SPEngineTech-K3 = SPEngineTech-K2,Navaho-TP-1960
	SPEngineTech-K4 = SPEngineTech-K3,H1-TP
	SPEngineTech-K5 = SPEngineTech-K4,8000
	SPEngineTech-K6 = SPEngineTech-K5,5000,Navaho-TP-1962 // We want to depend on RS27-System, but that depends on LR79-NA-13 and H-1-SaturnIB rather than just other TP entries.  So we have to have NRE of our own
	SPEngineTech-K7 = SPEngineTech-K6,3000 // 6000, RS-27
	SPEngineTech-K8 = SPEngineTech-K7,MerlinTP
	SPEngineTech-K9 = SPEngineTech-K8,MerlinDTP,2000
	SPEngineTech-K10 = SPEngineTech-K9,MerlinDTP,12000
}

@PART[*]:HAS[@MODULE[ModuleSPEngine]:HAS[#familyLetter[K]],!MODULE[TestFlightInterop]]:BEFORE[zTestFlight]
{
	!TESTFLIGHT,*{}
	TESTFLIGHT
	{
		name = SPEngine-K-0 // based on S-3
		ratedBurnTime = 165
		ignitionReliabilityStart = 0.79
		ignitionReliabilityEnd = 0.87
		cycleReliabilityStart = 0.8
		cycleReliabilityEnd = 0.867
	}
	TESTFLIGHT
	{
		name = SPEngine-K-1 // based on S-3D
		ratedBurnTime = 165
		ignitionReliabilityStart = 0.89
		ignitionReliabilityEnd = 0.97
		cycleReliabilityStart = 0.9
		cycleReliabilityEnd = 0.967
		techTransfer = SPEngine-K-0:50&S-3:25
	}
	TESTFLIGHT
	{
		name = SPEngine-K-2 // based on LR79-NA-9
		ratedBurnTime = 165
		ignitionReliabilityStart = 0.93
		ignitionReliabilityEnd = 0.988
		cycleReliabilityStart = 0.94
		cycleReliabilityEnd = 0.985
		techTransfer = SPEngine-K-1,SPEngine-K-0:50&S-3D,S-3:25
	}
	TESTFLIGHT
	{
		name = SPEngine-K-3 // based on LR79-NA-11
		ratedBurnTime = 165
		ignitionReliabilityStart = 0.95
		ignitionReliabilityEnd = 0.99
		cycleReliabilityStart = 0.95
		cycleReliabilityEnd = 0.99
		techTransfer = SPEngine-K-2,SPEngine-K-1,SPEngine-K-0:50&LR79-NA-9,S-3D,S-3:25
	}
	TESTFLIGHT
	{
		name = SPEngine-K-4 // based on H-1-SaturnI
		ratedBurnTime = 150
		ignitionReliabilityStart = 0.89
		ignitionReliabilityEnd = 0.97
		cycleReliabilityStart = 0.9
		cycleReliabilityEnd = 0.967
		// A little bit of techTransfer, but mainly it's a redesign (mass is down a lot, Isp is up).
		techTransfer = SPEngine-K-3,SPEngine-K-2,SPEngine-K-1,SPEngine-K-0:15&LR79NA-11,LR79-NA-9,S-3D,S-3:5
	}
	TESTFLIGHT
	{
		name = SPEngine-K-5 // based on H-1-SaturnIB
		ratedBurnTime = 180
		ignitionReliabilityStart = 0.93
		ignitionReliabilityEnd = 0.988
		cycleReliabilityStart = 0.94
		cycleReliabilityEnd = 0.985
		techTransfer = SPEngine-K-4:50&H-1-188K,H-1-165K:30
	}
	TESTFLIGHT
	{
		name = SPEngine-K-6 // based on RS-27
		ratedBurnTime = 240
		ignitionReliabilityStart = 0.96
		ignitionReliabilityEnd = 0.995
		cycleReliabilityStart = 0.96
		cycleReliabilityEnd = 0.995
		techTransfer = SPEngine-K-5,SPEngine-K-4:50&H-1-200K,H-1-188K:25
	}
	TESTFLIGHT
	{
		name = SPEngine-K-7 // based on RS-27A
		ratedBurnTime = 285
		ignitionReliabilityStart = 0.96
		ignitionReliabilityEnd = 0.995
		cycleReliabilityStart = 0.96
		cycleReliabilityEnd = 0.995
		techTransfer = SPEngine-K-6:75&RS-27:38
	}
	TESTFLIGHT
	{
		name = SPEngine-K-8 // based on Merlin1C
		ratedBurnTime = 300
		ignitionReliabilityStart = 0.98
		ignitionReliabilityEnd = 0.995
		cycleReliabilityStart = 0.98
		cycleReliabilityEnd = 0.995
		// A little bit of techTransfer, but mainly this is a whole new design.  TT from the Merlins, though.
		techTransfer = SPEngine-K-7:15&SPEngine-V-4:10&RS-27A:5&Merlin1B,Merlin1A:25&Merlin1BVac:5
	}
	TESTFLIGHT
	{
		name = SPEngine-K-9 // based on Merlin1D.  Not a robotic dog.
		ratedBurnTime = 350
		ignitionReliabilityStart = 0.98
		ignitionReliabilityEnd = 0.995
		cycleReliabilityStart = 0.98
		cycleReliabilityEnd = 0.995
		techTransfer = SPEngine-K-8:50&Merlin1C,Merlin1B,Merlin1A:25&Merlin1CVac,Merlin1BVac:5
	}
	TESTFLIGHT
	{
		name = SPEngine-K-10 // based on Merlin1D++
		ratedBurnTime = 350
		ignitionReliabilityStart = 0.98
		ignitionReliabilityEnd = 0.995
		cycleReliabilityStart = 0.98
		cycleReliabilityEnd = 0.995
		techTransfer = SPEngine-K-9,SPEngine-K-8:50&Merlin1D+,Merlin1D,Merlin1C,Merlin1B:25&Merlin1DVac,Merlin1CVac,Merlin1BVac:5
	}
}
