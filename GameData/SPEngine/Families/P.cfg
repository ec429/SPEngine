SPEFamily:NEEDS[RealFuels]
{
	letter = P
	description = Staged-combustion hypergolic engine.  Examples include RD-253 (Proton).
	usesPartUpgrades = True
	minTf = 0.3
	TechLevel
	{
		// RD-253
		puRequired = SPEngineTech-P0
		maxThrust = 2000
		isp
		{
			key = 0 315.5
			key = 1 284.5
		}
		PROPELLANT
		{
			name = UDMH
			ratio = 0.4071
			DrawGauge = True
		}
		PROPELLANT
		{
			name = NTO
			ratio = 0.5929
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 1.0
		}
		maxIgnitions = 1
		mass = 1.3275
		cost = 700
		toolCost = 13631 // yields 10000.1 for RD-253
	}
	TechLevel
	{
		// RD-253-Mk2
		puRequired = SPEngineTech-P1
		maxThrust = 2115
		isp
		{
			key = 0 316
			key = 1 285
		}
		PROPELLANT
		{
			name = UDMH
			ratio = 0.4071
			DrawGauge = True
		}
		PROPELLANT
		{
			name = NTO
			ratio = 0.5929
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 1.0
		}
		maxIgnitions = 1
		mass = 1.3275
		cost = 770
		toolCost = 16361 // yields 4002.8 to upgrade from an RD-253
	}
	TechLevel
	{
		// RD-253-Mk3
		puRequired = SPEngineTech-P2
		maxThrust = 2200
		isp
		{
			key = 0 316
			key = 1 285
		}
		PROPELLANT
		{
			name = UDMH
			ratio = 0.4071
			DrawGauge = True
		}
		PROPELLANT
		{
			name = NTO
			ratio = 0.5929
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 1.0
		}
		maxIgnitions = 1
		mass = 1.3275
		cost = 770
		toolCost = 18581 // yields 4029.3 to continue upgrading from an RD-253
	}
	TechLevel
	{
		// RD-253-Mk4
		puRequired = SPEngineTech-P3
		maxThrust = 2260
		isp
		{
			key = 0 316
			key = 1 285
		}
		PROPELLANT
		{
			name = UDMH
			ratio = 0.4071
			DrawGauge = True
		}
		PROPELLANT
		{
			name = NTO
			ratio = 0.5929
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 1.0
		}
		maxIgnitions = 1
		mass = 1.3275
		cost = 840
		toolCost = 20302 // yields 3988.9 to continue upgrading from an RD-253
	}
	TechLevel
	{
		// RD-275
		puRequired = SPEngineTech-P4
		maxThrust = 2260
		isp
		{
			key = 0 316
			key = 1 287
		}
		PROPELLANT
		{
			name = UDMH
			ratio = 0.4071
			DrawGauge = True
		}
		PROPELLANT
		{
			name = NTO
			ratio = 0.5929
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 1.0
		}
		maxIgnitions = 1
		mass = 1.315
		cost = 975
		toolCost = 27172 // yields 8018.9 to continue upgrading from an RD-253
	}
	TechLevel
	{
		// RD-275M
		puRequired = SPEngineTech-P5
		maxThrust = 2360
		isp
		{
			key = 0 315.8
			key = 1 288
		}
		PROPELLANT
		{
			name = UDMH
			ratio = 0.4071
			DrawGauge = True
		}
		PROPELLANT
		{
			name = NTO
			ratio = 0.5929
		}
		IGNITOR_RESOURCE
		{
			name = ElectricCharge
			amount = 1.0
		}
		maxIgnitions = 1
		mass = 1.315
		cost = 1111
		toolCost = 32623 // yields 7985.9 to continue upgrading from an RD-253
	}
}

PARTUPGRADE
{
	name = SPEngineTech-P0
	techRequired = stagedCombustion1965
	entryCost = 0
	cost = 0
	title = P-class Procedural Engine family
	basicInfo = Engine Performance Upgrade
	manufacturer = Engine Upgrade
	description = Unlocks the P-class Procedural Engine family at techlevel 1.\n\nResembling the Energomash RD-253, these booster engines burn storable hypergolic propellants in a staged-combustion cycle to achieve higher specific impulse than the T-class.
	partIcon = ROE-UpgradeIcon-Coatl
}

PARTUPGRADE
{
	name = SPEngineTech-P1
	techRequired = stagedCombustion1967
	entryCost = 0
	cost = 0
	title = P-class Procedural Engine upgrade: TL2
	basicInfo = Engine Performance Upgrade
	manufacturer = Engine Upgrade
	description = The P-class Procedural Engine family now supports techlevel 2 for increased performance.\n\nResembling the RD-253 Mk2, these engines offer increased thrust and reliability.
	partIcon = ROE-UpgradeIcon-Coatl
}

PARTUPGRADE
{
	name = SPEngineTech-P2
	techRequired = stagedCombustion1976
	entryCost = 0
	cost = 0
	title = P-class Procedural Engine upgrade: TL3
	basicInfo = Engine Performance Upgrade
	manufacturer = Engine Upgrade
	description = The P-class Procedural Engine family now supports techlevel 3 for increased performance.\n\nResembling the RD-253 Mk3, these engines provide a further increment to thrust and are slightly more reliable.
	partIcon = ROE-UpgradeIcon-Coatl
}

PARTUPGRADE
{
	name = SPEngineTech-P3
	techRequired = stagedCombustion1986
	entryCost = 0
	cost = 0
	title = P-class Procedural Engine upgrade: TL4
	basicInfo = Engine Performance Upgrade
	manufacturer = Engine Upgrade
	description = The P-class Procedural Engine family now supports techlevel 4 for increased performance.\n\nResembling the RD-253 Mk4, these engines offer slightly more thrust and are very reliable.
	partIcon = ROE-UpgradeIcon-Coatl
}

PARTUPGRADE
{
	name = SPEngineTech-P4
	techRequired = stagedCombustion1992
	entryCost = 0
	cost = 0
	title = P-class Procedural Engine upgrade: TL5
	basicInfo = Engine Performance Upgrade
	manufacturer = Engine Upgrade
	description = The P-class Procedural Engine family now supports techlevel 5 for increased performance.\n\nResembling the RD-275, these engines have marginally better atmospheric Isp but a reduced burntime.
	partIcon = ROE-UpgradeIcon-Coatl
}

PARTUPGRADE
{
	name = SPEngineTech-P5
	techRequired = stagedCombustion2004
	entryCost = 0
	cost = 0
	title = P-class Procedural Engine upgrade: TL6
	basicInfo = Engine Performance Upgrade
	manufacturer = Engine Upgrade
	description = The P-class Procedural Engine family now supports techlevel 6 for increased performance.\n\nResembling the RD-275M, these engines deliver slightly more thrust, especially at sea-level.
	partIcon = ROE-UpgradeIcon-Coatl
}

@ENTRYCOSTMODS:AFTER[RP-0]
{
	SPEngineTech-P0 = 30000,Proton-Family
	SPEngineTech-P1 = SPEngineTech-P0,6000
	SPEngineTech-P2 = SPEngineTech-P1,6000
	SPEngineTech-P3 = SPEngineTech-P2,6000
	SPEngineTech-P4 = SPEngineTech-P3,12000
	SPEngineTech-P5 = SPEngineTech-P4,12000
}

@PART[*]:HAS[@MODULE[ModuleSPEngine]:HAS[#familyLetter[P]],!MODULE[TestFlightInterop]]:BEFORE[zTestFlight]
{
	!TESTFLIGHT,*{}
	TESTFLIGHT
	{
		name = SPEngine-P-0 // based on RD-253
		ratedBurnTime = 148
		ignitionReliabilityStart = 0.9
		ignitionReliabilityEnd = 0.96
		cycleReliabilityStart = 0.88
		cycleReliabilityEnd = 0.93
		reliabilityMidH = 0.55
		reliabilityDataRateMultiplier = 0.5
	}
	TESTFLIGHT
	{
		name = SPEngine-P-1 // based on RD-253-Mk2
		ratedBurnTime = 148
		ignitionReliabilityStart = 0.93
		ignitionReliabilityEnd = 0.98
		cycleReliabilityStart = 0.92
		cycleReliabilityEnd = 0.96
		reliabilityMidH = 0.45
		reliabilityDataRateMultiplier = 0.5
		techTransfer = SPEngine-P-0:50&RD-253:25
	}
	TESTFLIGHT
	{
		name = SPEngine-P-2 // there's no TF config for RD-253-Mk3, so making up intermediate values
		ratedBurnTime = 148
		ignitionReliabilityStart = 0.94
		ignitionReliabilityEnd = 0.99
		cycleReliabilityStart = 0.93
		cycleReliabilityEnd = 0.97
		reliabilityMidH = 0.45
		reliabilityDataRateMultiplier = 0.5
		techTransfer = SPEngine-P-1,SPEngine-P-0:50&RD-253-Mk2,RD-253:25
	}
	TESTFLIGHT
	{
		name = SPEngine-P-3 // based on RD-253-Mk4
		ratedBurnTime = 148
		ignitionReliabilityStart = 0.95
		ignitionReliabilityEnd = 0.999
		cycleReliabilityStart = 0.94
		cycleReliabilityEnd = 0.995
		techTransfer = SPEngine-P-2,SPEngine-P-1,SPEngine-P-0:50&RD-253-Mk2:12
	}
	TESTFLIGHT
	{
		name = SPEngine-P-4 // based on RD-275
		ratedBurnTime = 129
		ignitionReliabilityStart = 0.928
		ignitionReliabilityEnd = 0.998
		cycleReliabilityStart = 0.928
		cycleReliabilityEnd = 0.998
		techTransfer = SPEngine-P-3,SPEngine-P-2,SPEngine-P-1:50&RD-253-Mk4:25
	}
	TESTFLIGHT
	{
		name = SPEngine-P-5 // based on RD-275M
		ratedBurnTime = 129
		ignitionReliabilityStart = 0.94
		ignitionReliabilityEnd = 0.998
		cycleReliabilityStart = 0.945
		cycleReliabilityEnd = 0.998
		techTransfer = SPEngine-P-4,SPEngine-P-3,SPEngine-P-2:50&RD-275,RD-253-Mk4:25
	}
}
